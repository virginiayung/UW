clear all; close all;

!A=[1 1900;1 1910; 1 1920; 1 1930; 1 1940; 1 1950; 1 1960; 1 1970; 1 1980; 1 1990; 1 2000; 1 2010]
a1=[1;1;1;1;1;1;1;1;1;1;1;1]
a2=[1900;1910;1920;1930;1940;1950;1960;1970;1980;1990;2000;2010]
A1=[a1 a2]
A2=[a1 a2 a2.^2]

b=[75.995;91.972;105.711;123.203;131.669;150.697;179.323;203.212;226.505;249.633;281.422;308.745]


!transpose(A)*A
!transpose(A)*b
[q1,r1] = qr(A1,0)
transpose(q1)*b

x1=r1\(transpose(q1)*b)

y1 = x1(1,1) + (x1(2,1)*2020)

save pop2020_deg1.dat y1 -ascii

[q2,r2] = qr(A2,0)
transpose(q2)*b

x2=r2\(transpose(q2)*b)

y2 = x2(1,1) + (x2(2,1)*2020) +(x2(3,1)*(2020^2))

save pop2020_deg2.dat y2 -ascii




